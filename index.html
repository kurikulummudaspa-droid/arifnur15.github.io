<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Agenda Guru — Catatan Harian • Buku • Ketercapaian</title>
  <style>
    :root{--bg:#f6f7fb;--card:#fff;--muted:#6b7280;--accent:#0b5cff}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0;background:var(--bg);color:#111}
    header{background:linear-gradient(90deg,#ffffffcc, #eef2ff);padding:1rem;border-bottom:1px solid #e6e9ef}
    .container{max-width:980px;margin:1rem auto;padding:0 1rem}
    h1{font-size:1.05rem;margin:0 0 .25rem}
    p.lead{margin:0;color:var(--muted);font-size:.9rem}
    .grid{display:grid;gap:1rem;grid-template-columns:1fr}
    @media(min-width:900px){.grid{grid-template-columns:1fr 420px}}
    .card{background:var(--card);padding:1rem;border-radius:10px;box-shadow:0 2px 6px rgba(16,24,40,0.04);border:1px solid #eef2f6}
    label{display:block;font-size:.85rem;margin-bottom:.25rem;color:var(--muted)}
    input[type=text],textarea,select,input[type=date]{width:100%;padding:.6rem;border-radius:8px;border:1px solid #dfe7f2;font-size:.95rem}
    textarea{min-height:90px}
    .row{display:flex;gap:.5rem;align-items:center}
    button{background:var(--accent);color:white;border:0;padding:.55rem .75rem;border-radius:8px;cursor:pointer}
    button.ghost{background:transparent;color:var(--accent);border:1px solid #d6e1ff}
    .small{font-size:.85rem}
    .list{margin:0;padding:0;list-style:none}
    .item{padding:.6rem;border-radius:8px;border:1px solid #f0f4ff;margin-bottom:.5rem;background:linear-gradient(180deg,#fff,#fbfdff)}
    .meta{font-size:.8rem;color:var(--muted)}
    .tag{display:inline-block;padding:.15rem .45rem;border-radius:999px;border:1px solid #e6eefc;font-size:.75rem}
    .flex-between{display:flex;justify-content:space-between;align-items:center}
    .controls{display:flex;gap:.5rem;flex-wrap:wrap}
    .pill{padding:.25rem .5rem;border-radius:999px;border:1px solid #e6e9ef;font-size:.8rem}
    .color-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:.4rem}
    .status-0{background:#fef3f2;color:#b91c1c}
    .status-1{background:#fff7ed;color:#92400e}
    .status-2{background:#ecfdf5;color:#065f46}
    .muted-center{text-align:center;color:var(--muted);padding:.8rem}
    footer{max-width:980px;margin:1rem auto;padding:0 1rem;color:var(--muted);font-size:.85rem}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Agenda Guru</h1>
      <p class="lead">Aplikasi ringan untuk mencatat catatan harian, buku yang dibaca, dan melacak ketercapaian tujuan pembelajaran. Data disimpan di browser (localStorage).</p>
    </div>
  </header>

  <main class="container">
    <div class="grid">
      <section class="card">
        <div class="flex-between">
          <div>
            <strong>Catatan Harian</strong>
            <div class="meta">Buat catatan per hari — tugas, refleksi, tindak lanjut.</div>
          </div>
          <div class="controls small">
            <label for="filterDate" class="small" style="margin:0">Tanggal</label>
            <input id="filterDate" type="date" />
            <button id="btnNewNote" class="ghost">Baru</button>
          </div>
        </div>

        <div style="margin-top:1rem">
          <label for="noteTitle">Judul</label>
          <input id="noteTitle" type="text" placeholder="Contoh: RPP, Observasi Kelas" />
          <label for="noteBody" style="margin-top:.6rem">Isi Catatan</label>
          <textarea id="noteBody" placeholder="Tulis catatan harian..."></textarea>

          <div class="row" style="margin-top:.6rem">
            <input id="noteDate" type="date" style="max-width:180px" />
            <select id="noteTag" style="max-width:220px;margin-left:auto">
              <option value="Umum">Umum</option>
              <option value="Observasi">Observasi</option>
              <option value="RPP">RPP</option>
              <option value="Tindak Lanjut">Tindak Lanjut</option>
            </select>
          </div>

          <div style="display:flex;gap:.5rem;margin-top:.6rem">
            <button id="saveNote">Simpan Catatan</button>
            <button id="exportNotes" class="ghost">Ekspor CSV</button>
            <button id="clearNotes" class="ghost">Hapus Semua</button>
          </div>
        </div>

        <hr style="margin:1rem 0;border:none;border-top:1px dashed #eef2ff"/>
        <div id="notesList" aria-live="polite"></div>
      </section>

      <aside>
        <div class="card" style="margin-bottom:1rem">
          <strong>Log Buku yang Dibaca</strong>
          <div class="meta">Catat buku referensi, refleksi, halaman penting.</div>

          <div style="margin-top:.6rem">
            <label for="bookTitle">Judul Buku</label>
            <input id="bookTitle" type="text" placeholder="Judul — Pengarang (tahun)" />
            <label for="bookNotes" style="margin-top:.5rem">Catatan singkat</label>
            <textarea id="bookNotes" placeholder="Kutipan, halaman, relevansi pembelajaran..."></textarea>
            <div style="display:flex;gap:.5rem;margin-top:.5rem">
              <button id="saveBook">Simpan Buku</button>
              <button id="exportBooks" class="ghost">Ekspor</button>
            </div>
          </div>

          <hr style="margin:1rem 0;border:none;border-top:1px dashed #eef2ff"/>
          <ul id="booksList" class="list"></ul>
        </div>

        <div class="card">
          <strong>Ketercapaian Tujuan Pembelajaran</strong>
          <div class="meta">Buat tujuan, indikator, dan tandai status (0=Belum,1=Sebagian,2=Tercapai)</div>

          <div style="margin-top:.6rem">
            <label for="objText">Tujuan / Indikator</label>
            <input id="objText" type="text" placeholder="Contoh: Siswa dapat menjelaskan faktor yang mempengaruhi laju reaksi" />
            <label for="objClass" style="margin-top:.4rem">Mata Pelajaran / Kelas</label>
            <input id="objClass" type="text" placeholder="Kimia XI / 11 IPA" />
            <div style="display:flex;gap:.5rem;margin-top:.5rem">
              <button id="saveObj">Simpan Tujuan</button>
              <button id="exportObj" class="ghost">Ekspor</button>
            </div>
          </div>

          <hr style="margin:1rem 0;border:none;border-top:1px dashed #eef2ff"/>
          <div id="objsList"></div>
        </div>
      </aside>
    </div>
  </main>

  <footer>
    <div class="container">Versi sederhana • Data lokal (localStorage). Untuk penggunaan kolaboratif/backup, ekspor data dan simpan di penyimpanan institusi.</div>
  </footer>

  <script>
    // ======= Helpers =======
    const uid = ()=>Date.now().toString(36)+Math.random().toString(36).slice(2,7)
    const qs = (s)=>document.querySelector(s)
    const qsa = (s)=>Array.from(document.querySelectorAll(s))

    // ======= Storage keys =======
    const KEY_NOTES='agenda_guru_notes_v1'
    const KEY_BOOKS='agenda_guru_books_v1'
    const KEY_OBJS='agenda_guru_objs_v1'

    // ======= Load / Save =======
    const load = (k)=>{try{return JSON.parse(localStorage.getItem(k)||'[]')}catch(e){return []}}
    const save = (k,v)=>localStorage.setItem(k,JSON.stringify(v))

    // ======= Notes =======
    function renderNotes(){
      const notes=load(KEY_NOTES).sort((a,b)=>b.date.localeCompare(a.date))
      const container=qs('#notesList')
      container.innerHTML=''
      if(!notes.length){container.innerHTML='<div class="muted-center">Belum ada catatan.</div>';return}
      notes.forEach(n=>{
        const div=document.createElement('div');div.className='item'
        div.innerHTML=`
          <div class="flex-between">
            <div><strong>${escapeHtml(n.title||'(Tanpa judul)')}</strong><div class="meta">${n.date}</div></div>
            <div style="text-align:right">
              <div class="meta">${escapeHtml(n.tag||'Umum')}</div>
              <div style="margin-top:.4rem"><button class="ghost" data-id="${n.id}" data-act="edit">Edit</button>
              <button class="ghost" data-id="${n.id}" data-act="del">Hapus</button></div>
            </div>
          </div>
          <div style="margin-top:.6rem">${nl2br(escapeHtml(n.body||''))}</div>
        `
        container.appendChild(div)
      })
    }

    function saveNote(){
      const title=qs('#noteTitle').value.trim()
      const body=qs('#noteBody').value.trim()
      const date=qs('#noteDate').value || new Date().toISOString().slice(0,10)
      const tag=qs('#noteTag').value
      if(!body && !title){alert('Isi catatan atau judul.');return}
      const notes=load(KEY_NOTES)
      notes.push({id:uid(),title,body,date,tag})
      save(KEY_NOTES,notes)
      renderNotes(); clearNoteForm()
    }

    function clearNoteForm(){qs('#noteTitle').value='';qs('#noteBody').value='';}

    // ======= Books =======
    function renderBooks(){
      const books=load(KEY_BOOKS)
      const el=qs('#booksList');el.innerHTML=''
      if(!books.length){el.innerHTML='<div class="muted-center">Belum ada buku tercatat.</div>';return}
      books.slice().reverse().forEach(b=>{
        const li=document.createElement('li');li.className='item'
        li.innerHTML=`<div class="flex-between"><div><strong>${escapeHtml(b.title)}</strong><div class="meta">${b.date}</div></div>
          <div><button class="ghost" data-id="${b.id}" data-act="delBook">Hapus</button></div></div>
          <div style="margin-top:.5rem">${nl2br(escapeHtml(b.notes))}</div>`
        el.appendChild(li)
      })
    }

    function saveBook(){
      const title=qs('#bookTitle').value.trim();const notes=qs('#bookNotes').value.trim()
      if(!title){alert('Masukkan judul buku.');return}
      const books=load(KEY_BOOKS)
      books.push({id:uid(),title,notes,date:new Date().toISOString().slice(0,10)})
      save(KEY_BOOKS,books);renderBooks();qs('#bookTitle').value='';qs('#bookNotes').value=''
    }

    // ======= Objectives =======
    function renderObjs(){
      const objs=load(KEY_OBJS)
      const el=qs('#objsList');el.innerHTML=''
      if(!objs.length){el.innerHTML='<div class="muted-center">Belum ada tujuan pembelajaran.</div>';return}
      objs.forEach(o=>{
        const div=document.createElement('div');div.className='item'
        div.innerHTML=`
          <div class="flex-between">
            <div>
              <strong>${escapeHtml(o.text)}</strong>
              <div class="meta">${escapeHtml(o.klass||'—')}</div>
            </div>
            <div style="text-align:right">
              <select data-id="${o.id}" class="statusSelect">
                <option value="0" ${o.status==0?'selected':''}>Belum</option>
                <option value="1" ${o.status==1?'selected':''}>Sebagian</option>
                <option value="2" ${o.status==2?'selected':''}>Tercapai</option>
              </select>
              <div style="margin-top:.4rem"><button class="ghost" data-id="${o.id}" data-act="delObj">Hapus</button></div>
            </div>
          </div>
        `
        el.appendChild(div)
      })
      qsa('.statusSelect').forEach(s=>s.addEventListener('change',e=>{
        const id=e.target.dataset.id; const st=Number(e.target.value)
        const arr=load(KEY_OBJS).map(it=>it.id===id?{...it,status:st}:it)
        save(KEY_OBJS,arr);renderObjs()
      }))
    }

    function saveObj(){
      const text=qs('#objText').value.trim();const klass=qs('#objClass').value.trim()
      if(!text){alert('Masukkan tujuan atau indikator.');return}
      const objs=load(KEY_OBJS)
      objs.push({id:uid(),text,klass,status:0,created:new Date().toISOString()})
      save(KEY_OBJS,objs);renderObjs();qs('#objText').value='';qs('#objClass').value=''
    }

    // ======= Events =======
    qs('#saveNote').addEventListener('click',saveNote)
    qs('#saveBook').addEventListener('click',saveBook)
    qs('#saveObj').addEventListener('click',saveObj)

    qs('#notesList').addEventListener('click',e=>{
      const btn=e.target.closest('button'); if(!btn) return
      const id=btn.dataset.id; const act=btn.dataset.act
      if(act==='del'){if(confirm('Hapus catatan?')){const arr=load(KEY_NOTES).filter(n=>n.id!==id);save(KEY_NOTES,arr);renderNotes()}}
      if(act==='edit'){const notes=load(KEY_NOTES);const n=notes.find(x=>x.id===id);if(n){qs('#noteTitle').value=n.title;qs('#noteBody').value=n.body;qs('#noteDate').value=n.date}}
    })

    qs('#booksList').addEventListener('click',e=>{const btn=e.target.closest('button');if(!btn)return; if(btn.dataset.act==='delBook'){if(confirm('Hapus buku?')){const arr=load(KEY_BOOKS).filter(b=>b.id!==btn.dataset.id);save(KEY_BOOKS,arr);renderBooks()}}})
    qs('#objsList').addEventListener('click',e=>{const btn=e.target.closest('button');if(!btn)return; if(btn.dataset.act==='delObj'){if(confirm('Hapus tujuan?')){const arr=load(KEY_OBJS).filter(b=>b.id!==btn.dataset.id);save(KEY_OBJS,arr);renderObjs()}}})

    // ======= Export/Import =======
    function toCSV(arr,fields){
      const esc = (s)=>('"'+String(s||'').replace(/"/g,'""')+'"')
      const hdr = fields.join(',')
      const rows = arr.map(r=>fields.map(f=>esc(r[f]||'')).join(','))
      return [hdr].concat(rows).join('\n')
    }

    function download(filename, text){
      const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([text],{type:'text/plain'}));a.download=filename;document.body.appendChild(a);a.click();a.remove()
    }

    qs('#exportNotes').addEventListener('click',()=>{
      const arr=load(KEY_NOTES); if(!arr.length){alert('Tidak ada catatan.');return}
      const csv=toCSV(arr,['id','date','title','tag','body']);download('catatan_harian.csv',csv)
    })
    qs('#exportBooks').addEventListener('click',()=>{const arr=load(KEY_BOOKS);if(!arr.length){alert('Tidak ada buku.');return}download('buku_terbaca.json',JSON.stringify(arr,0,2))})
    qs('#exportObj').addEventListener('click',()=>{const arr=load(KEY_OBJS);if(!arr.length){alert('Tidak ada tujuan.');return}download('tujuan_pembelajaran.json',JSON.stringify(arr,0,2))})

    qs('#clearNotes').addEventListener('click',()=>{if(confirm('Hapus semua catatan?')){localStorage.removeItem(KEY_NOTES);renderNotes()}})
    qs('#btnNewNote').addEventListener('click',()=>{qs('#noteDate').value=new Date().toISOString().slice(0,10);qs('#noteTitle').focus()})

    qs('#filterDate').addEventListener('change',e=>{
      const d=e.target.value; if(!d){renderNotes();return}
      const arr=load(KEY_NOTES).filter(n=>n.date===d)
      const container=qs('#notesList');container.innerHTML=''
      if(!arr.length){container.innerHTML='<div class="muted-center">Tidak ada catatan pada tanggal ini.</div>';return}
      arr.forEach(n=>{const div=document.createElement('div');div.className='item';div.innerHTML=`<div class="flex-between"><div><strong>${escapeHtml(n.title||'(Tanpa judul)')}</strong><div class="meta">${n.date}</div></div><div class="meta">${escapeHtml(n.tag||'Umum')}</div></div><div style="margin-top:.5rem">${nl2br(escapeHtml(n.body||''))}</div>`;container.appendChild(div)})
    })

    // Initialization
    renderNotes();renderBooks();renderObjs();qs('#noteDate').value=new Date().toISOString().slice(0,10)

    // ======= Utilities =======
    function escapeHtml(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')}
    function nl2br(s){return s.replace(/\n/g,'<br/>')}
  </script>
</body>
</html>